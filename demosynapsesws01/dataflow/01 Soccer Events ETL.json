{
	"name": "01 Soccer Events ETL",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "Soccer_Event_DS_Events",
						"type": "DatasetReference"
					},
					"name": "Events"
				},
				{
					"dataset": {
						"referenceName": "Soccer_Event_DS_GameInfo",
						"type": "DatasetReference"
					},
					"name": "GameInfo"
				}
			],
			"sinks": [],
			"transformations": [
				{
					"name": "CleanNULL"
				}
			],
			"script": "source(output(\n\t\tid_odsp as string,\n\t\tid_event as string,\n\t\tsort_order as integer,\n\t\ttime as integer,\n\t\ttext as string,\n\t\tevent_type as integer,\n\t\tevent_type2 as integer,\n\t\tside as integer,\n\t\tevent_team as string,\n\t\topponent as string,\n\t\tplayer as string,\n\t\tplayer2 as string,\n\t\tplayer_in as string,\n\t\tplayer_out as string,\n\t\tshot_place as integer,\n\t\tshot_outcome as integer,\n\t\tis_goal as integer,\n\t\tlocation as integer,\n\t\tbodypart as integer,\n\t\tassist_method as integer,\n\t\tsituation as integer,\n\t\tfast_break as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> Events\nsource(output(\n\t\tid_odsp as string,\n\t\tlink_odsp as string,\n\t\tadv_stats as boolean,\n\t\tdate as timestamp,\n\t\tleague as string,\n\t\tseason as integer,\n\t\tcountry as string,\n\t\tht as string,\n\t\tat as string,\n\t\tfthg as integer,\n\t\tftag as integer,\n\t\todd_h as double,\n\t\todd_d as double,\n\t\todd_a as double,\n\t\todd_over as double,\n\t\todd_under as double,\n\t\todd_bts as double,\n\t\todd_bts_n as double\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> GameInfo\nEvents derive(player = iifNull(player,'NA'),\n\t\tevent_team = iifNull(event_team,'NA'),\n\t\topponent = iifNull(opponent,'NA'),\n\t\tevent_type = iifNull(event_type,99),\n\t\tevent_type2 = iifNull(event_type2,99),\n\t\tshot_place = iifNull(shot_place,99),\n\t\tshot_outcome = iifNull(shot_outcome,99),\n\t\tlocation = iifNull(location,99),\n\t\tbodypart = iifNull(bodypart,99),\n\t\tassist_method = iifNull(assist_method,99),\n\t\tsituation = iifNull(situation,99)) ~> CleanNULL"
		}
	}
}